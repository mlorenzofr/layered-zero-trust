# Default values for supply-chain
global:
  hubClusterDomain: hub.example.com
  namespace: pipeline
  secretStore:
    name: "vault-backend"
    kind: "ClusterSecretStore"

rhtas:
  enabled: false

rhtpa:
  enabled: false
  oidcRealm: "ztvp"
  clientId: "rhtpa-cli"
  clientSecretName: "qtodo-rhtpa-cli-password"
  # RHTPA OIDC CLI secret path (infra)
  clientSecretVaultPath: "secret/data/hub/infra/rhtpa/rhtpa-oidc-cli"
  clientSecretVaultKey: "client-secret"

# qtodo repository configuration
qtodo:
  repository: "https://github.com/validatedpatterns-demos/qtodo.git"
  revision: "main"
  tag: "latest"
  buildCmd: "./mvnw -s settings.xml package -DskipTests -Dquarkus.package.jar.type=uber-jar"
  containerfile: "./Containerfile"

# ===========================================================================
# BUILT-IN QUAY REGISTRY (optional)
# When enabled, deploys internal Quay registry with auto-generated credentials
# ===========================================================================
quay:
  enabled: true
  email: "quay-user@example.com"
  # Vault path for auto-generated Quay credentials
  vaultPath: "secret/data/hub/infra/quay/quay-users"
  passwordVaultKey: "quay-user-password"
  # User provisioner job settings
  job:
    image: registry.access.redhat.com/ubi9/ubi:9.7-1764794285
    schedule: "*/5 * * * *"

# ===========================================================================
# EXTERNAL/BYO REGISTRY (optional)
# User-provided credentials for external registry (quay.io, ghcr.io, etc.)
# Enable this when using an external registry instead of built-in Quay
# ===========================================================================
externalRegistry:
  enabled: false
  # Vault path for user-provided credentials
  vaultPath: "secret/data/hub/infra/registry/registry-user"
  passwordVaultKey: "registry-password"

# ===========================================================================
# COMMON REGISTRY SETTINGS (shared by both built-in Quay and external registry)
# ===========================================================================
registry:
  # For built-in Quay: domain is auto-constructed from hubClusterDomain
  # For external registry: REQUIRED - set explicitly (e.g., quay.io, ghcr.io)
  # domain: "registry.example.com"
  org: "ztvp"
  repo: "qtodo"
  tlsVerify: "true"
  user: "registry-user"
  # Secret name for registry auth (dockerconfigjson)
  authSecretName: "qtodo-registry-auth"
  # Embedded OCP registry only: create image namespace (registry.org) and grant
  # pipeline SA system:image-builder so the pipeline can push. Set to true only when
  # using the in-cluster OpenShift image registry; leave false for quay.io or other external registries.
  embeddedOCP:
    ensureImageNamespaceRBAC: false

# pipeline run configuration
pipelinerun:
  # Set to true to automatically trigger a pipeline run on ArgoCD sync
  enabled: false

# spire configuration
spire:
  enabled: true
  endpointSocketPath: "/spiffe-workload-api/spire-agent.sock"

# workspaces configuration
storage:
  pvcs:
    - name: qtodo-workspace-source
      storageClass: ""
      size: "2Gi"
      accessMode: ReadWriteOnce

# tekton tasks configuration
tasks:
  images:
    cosign: "registry.access.redhat.com/ubi9/ubi:9.7-1764794285"
    mandrel: "registry.redhat.io/quarkus/mandrel-for-jdk-21-rhel8:23.1-36"
    syft: "registry.redhat.io/rh-syft-tech-preview/syft-rhel9:1.29.0"
    rhtpa: "registry.access.redhat.com/ubi9/ubi:9.7-1764794285"